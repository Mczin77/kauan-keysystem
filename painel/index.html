<!DOCTYPE html>
<html>
<head>
<title>Painel KeySystem</title>
</head>
<body>

<h2>Login</h2>
<input id="user" placeholder="Usuário"><br>
<input id="pass" placeholder="Senha" type="password"><br>
<button onclick="login()">Entrar</button>

<hr>

<h2>Gerar Key</h2>
<button onclick="genKey()">Gerar</button>

<pre id="out"></pre>

<script>
let secret = null;

async function login() {
  const r = await fetch("/api/login", {
    method: "POST",
    headers: {"Content-Type": "application/json"},
    body: JSON.stringify({
      user: document.getElementById("user").value,
      pass: document.getElementById("pass").value
    })
  });
  const j = await r.json();
  if (j.ok) {
    secret = j.secret;
    alert("Logado!");
  } else {
    alert("Login inválido");
  }
}

async function genKey() {
  if (!secret) return alert("Faça login!");
  const r = await fetch("/api/generate", {
    method: "POST",
    headers: {"Content-Type": "application/json"},
    body: JSON.stringify({ secret })
  });
  const j = await r.json();
  document.getElementById("out").innerText = j.key || "Erro";
}
</script>

</body>
</html>
